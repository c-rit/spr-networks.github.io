"use strict";(self.webpackChunkspr_docs=self.webpackChunkspr_docs||[]).push([[2318],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>m});var r=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var s=r.createContext({}),c=function(e){var t=r.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},p=function(e){var t=c(e.components);return r.createElement(s.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=c(a),h=n,m=u["".concat(s,".").concat(h)]||u[h]||d[h]||i;return a?r.createElement(m,o(o({ref:t},p),{},{components:a})):r.createElement(m,o({ref:t},p))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,o=new Array(i);o[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:n,o[1]=l;for(var c=2;c<i;c++)o[c]=a[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,a)}h.displayName="MDXCreateElement"},3860:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>c});var r=a(7462),n=(a(7294),a(3905));const i={slug:"barely-ap-surfaces",title:"Attack Surface Reduction Research (Part 1)",authors:"ltsrad",tags:["Python","Scapy","WiFi","Linux"]},o=void 0,l={permalink:"/pages/blog/barely-ap-surfaces",source:"@site/blog/2023-10-23-barely-attack-surface-experiments.md",title:"Attack Surface Reduction Research (Part 1)",description:"Reducing Attack Surfaces (Part 1)",date:"2023-10-23T00:00:00.000Z",formattedDate:"October 23, 2023",tags:[{label:"Python",permalink:"/pages/blog/tags/python"},{label:"Scapy",permalink:"/pages/blog/tags/scapy"},{label:"WiFi",permalink:"/pages/blog/tags/wi-fi"},{label:"Linux",permalink:"/pages/blog/tags/linux"}],readingTime:2.58,hasTruncateMarker:!1,authors:[{name:"Alex Radocea",url:"https://twitter.com/defendtheworld",key:"ltsrad"}],frontMatter:{slug:"barely-ap-surfaces",title:"Attack Surface Reduction Research (Part 1)",authors:"ltsrad",tags:["Python","Scapy","WiFi","Linux"]},nextItem:{title:"One Weird Trick to fix your CTF Payloads",permalink:"/pages/blog/scapy-revfrag"}},s={authorsImageUrls:[void 0]},c=[{value:"Reducing Attack Surfaces (Part 1)",id:"reducing-attack-surfaces-part-1",level:2},{value:"Targeting the Whole WiFi Stack",id:"targeting-the-whole-wifi-stack",level:2},{value:"Developing a Shim Explained",id:"developing-a-shim-explained",level:2},{value:"Interested in working with us? Please reach out",id:"interested-in-working-with-us-please-reach-out",level:2}],p={toc:c};function u(e){let{components:t,...a}=e;return(0,n.kt)("wrapper",(0,r.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"reducing-attack-surfaces-part-1"},"Reducing Attack Surfaces (Part 1)"),(0,n.kt)("p",null,"SPR lets users create adaptive, micro-segmented networks for connecting and managing devices.\nIn addition to fine-grained network visibility we also build hardened software and\nwork to avoid common security flaws. As SPR has matured we've started taking on further efforts\nto eliminate attack surfaces."),(0,n.kt)("p",null,"When it comes to native code: we introduce none. As in, we have not written new native code for SPR anywhere.\nWe have one BPF filter, and its otherwise golang all the way down. We also do not run standard native services\nwhere we can avoid them. We have replaced traditional C code for services such as DNS and DHCP with golang implementations, namely CoreDNS and CoreDHCP."),(0,n.kt)("p",null,"The remaining native code targets that we have in SPR are as follows:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"The Linux kernel. For example: ethernet, the tcp/ip stack, nftables, the mac80211 framework and vendor drivers"),(0,n.kt)("li",{parentName:"ul"},"802.11 Firmware, Ethernet Firmware"),(0,n.kt)("li",{parentName:"ul"},"Hostapd"),(0,n.kt)("li",{parentName:"ul"},"PPP Daemon (off by default)"),(0,n.kt)("li",{parentName:"ul"},"OS Services (Ubuntu)")),(0,n.kt)("h2",{id:"targeting-the-whole-wifi-stack"},"Targeting the Whole WiFi Stack"),(0,n.kt)("p",null,"We believe the wifi firmware to be today's most insecure target (along with the vendor drivers). Many firmwares are blackbox,\npoorly documented, and opaque to public security research. We want SPR to be immune to attacks like ",(0,n.kt)("a",{parentName:"p",href:"https://blog.exodusintel.com/2017/07/26/broadpwn/"},"Broadpwn"),"\nand ",(0,n.kt)("a",{parentName:"p",href:"https://i.blackhat.com/USA-19/Thursday/us-19-Pi-Exploiting-Qualcomm-WLAN-And-Modem-Over-The-Air-wp.pdf"},"Qualcomm Exploitation"),"."),(0,n.kt)("p",null,"We've previously published ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/spr-networks/barely-ap"},"barely-ap")," to teach people about WiFi authentication.\nIt can and does work with real wifi chips running in monitor mode to connect clients over the air. We've tested with Android, iOS, and Linux devices."),(0,n.kt)("p",null,"The plan is to build a series of experiments to host high-speed wifi."),(0,n.kt)("p",null,"In the near term:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Develop a Proof-of-Concept AP with scapy in monitor mode (DONE)"),(0,n.kt)("li",{parentName:"ol"},"Develop a shim from monitor frames to hostapd running under mac80211_hwsim. This is a work in progress.\nWe would like to see a rust kernel driver/userland daemon for this")),(0,n.kt)("p",null,"Future:"),(0,n.kt)("ol",{start:3},(0,n.kt)("li",{parentName:"ol"},"A full AP written in rust, operating on raw 802.11 frames (not relying on the Linux kernel 802.11 subsystem)"),(0,n.kt)("li",{parentName:"ol"},"Rust protocol firmware for a wifi chip.")),(0,n.kt)("h2",{id:"developing-a-shim-explained"},"Developing a Shim Explained"),(0,n.kt)("p",null,"By running the card in monitor mode,  protocol parsing in the card firmware is substantially reduced if not altogether eliminated."),(0,n.kt)("p",null,"And with relaying frames over to macsim, hostapd is good to go.\nWhat needs to happen however is making this incredibly fast, and researching rate negotiation and\nwhat calls might need to be made to firmware to enable higher coding rates."),(0,n.kt)("p",null,"By using hostapd and the kernel mac80211 stack, we still maintain some native attack surface, however we get a known working,\nsecurity-tested AP that will be compatible with a wide variety of devices, without the firmware protocol parsing and the vendor driver parsing."),(0,n.kt)("p",null,"For next steps, a proof-of-concept with scapy is actually much too slow. We want to start\nwith a rust userland daemon leveraging iouring. If that doesn't fly then we'll go to a shim in the kernel."),(0,n.kt)("h2",{id:"interested-in-working-with-us-please-reach-out"},"Interested in working with us? Please reach out"),(0,n.kt)("p",null,"We are actively seeking an intern to help develop rust+wifi for SPR."),(0,n.kt)("p",null,"You can contact us at  spr-wifi ","[ a-t ]"," supernetworks.org  or hop on the ",(0,n.kt)("a",{parentName:"p",href:"https://discord.gg/EUjTKJPPAX"},"discord")))}u.isMDXComponent=!0}}]);