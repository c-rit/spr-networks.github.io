"use strict";(self.webpackChunkspr_docs=self.webpackChunkspr_docs||[]).push([[6653],{3905:(e,t,i)=>{i.d(t,{Zo:()=>p,kt:()=>h});var a=i(67294);function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function o(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function n(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(Object(i),!0).forEach((function(t){r(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function s(e,t){if(null==e)return{};var i,a,r=function(e,t){if(null==e)return{};var i,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)i=o[a],t.indexOf(i)>=0||(r[i]=e[i]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)i=o[a],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),i=t;return e&&(i="function"==typeof e?e(t):n(n({},t),e)),i},p=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var i=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(i),m=r,h=d["".concat(l,".").concat(m)]||d[m]||u[m]||o;return i?a.createElement(h,n(n({ref:t},p),{},{components:i})):a.createElement(h,n({ref:t},p))}));function h(e,t){var i=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=i.length,n=new Array(o);n[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:r,n[1]=s;for(var c=2;c<o;c++)n[c]=i[c];return a.createElement.apply(null,n)}return a.createElement.apply(null,i)}m.displayName="MDXCreateElement"},47215:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>n,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var a=i(87462),r=(i(67294),i(3905));const o={},n="Security",s={unversionedId:"security",id:"security",title:"Security",description:"Contact Information",source:"@site/docs/security.md",sourceDirName:".",slug:"/security",permalink:"/pages/docs/security",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Raspberry Pi 4 Model B Hardware Guide",permalink:"/pages/docs/pi4b"},next:{title:"Setup Guide",permalink:"/pages/docs/setup_run_spr"}},l={},c=[{value:"Contact Information",id:"contact-information",level:3},{value:"Threat Actors",id:"threat-actors",level:2},{value:"Remote Internet Attacker",id:"remote-internet-attacker",level:4},{value:"Man In The Middle / Malicious ISP",id:"man-in-the-middle--malicious-isp",level:4},{value:"Supply Chain Attacker",id:"supply-chain-attacker",level:4},{value:"Physical Proximity Attacker (Evil Neighbor)",id:"physical-proximity-attacker-evil-neighbor",level:4},{value:"Inside Perimeter Attacker (Evil Guest)",id:"inside-perimeter-attacker-evil-guest",level:4},{value:"Compromised Device Attacker (Implant)",id:"compromised-device-attacker-implant",level:4},{value:"Threat Vectors",id:"threat-vectors",level:2},{value:"Network Flaws",id:"network-flaws",level:3},{value:"Weak Passphrase / Password Reuse",id:"weak-passphrase--password-reuse",level:4},{value:"ARP Spoofing",id:"arp-spoofing",level:4},{value:"MAC Spoofing",id:"mac-spoofing",level:4},{value:"DHCP MAC Spoofing",id:"dhcp-mac-spoofing",level:4},{value:"VLAN Hopping",id:"vlan-hopping",level:4},{value:"Insecure Private Requests from Web Browsers",id:"insecure-private-requests-from-web-browsers",level:4},{value:"Software Implementation Flaws",id:"software-implementation-flaws",level:3},{value:"Memory corruption",id:"memory-corruption",level:4},{value:"Command Injection",id:"command-injection",level:4},{value:"XSS, CSRF",id:"xss-csrf",level:4},{value:"DNS Cache Poisoning",id:"dns-cache-poisoning",level:4},{value:"Response Splitting Attacks",id:"response-splitting-attacks",level:4},{value:"802.11 Flaws",id:"80211-flaws",level:3},{value:"Cryptographic Vulnerabilities",id:"cryptographic-vulnerabilities",level:4},{value:"Password Cracking",id:"password-cracking",level:4},{value:"Frag Attacks",id:"frag-attacks",level:4},{value:"MITM",id:"mitm",level:4},{value:"AP Isolation Bypass",id:"ap-isolation-bypass",level:4},{value:"Packet in Packet Attacks",id:"packet-in-packet-attacks",level:4},{value:"Key Security Features",id:"key-security-features",level:2},{value:"Multi-PSK &amp; VLANs",id:"multi-psk--vlans",level:2},{value:"No MAC spoofing and other layer 2 network pivoting",id:"no-mac-spoofing-and-other-layer-2-network-pivoting",level:3},{value:"Multicast Limitation",id:"multicast-limitation",level:3},{value:"Upstream LAN Traffic Blocked By Default",id:"upstream-lan-traffic-blocked-by-default",level:2},{value:"WPA3 Support",id:"wpa3-support",level:2},{value:"Practical Limitations of WPA3",id:"practical-limitations-of-wpa3",level:3},{value:"iOS Device QR-Code WPA2 Downgrade",id:"ios-device-qr-code-wpa2-downgrade",level:4},{value:"Many devices don&#39;t support WPA3 yet, some still require WPA1 even",id:"many-devices-dont-support-wpa3-yet-some-still-require-wpa1-even",level:4}],p={toc:c};function d(e){let{components:t,...i}=e;return(0,r.kt)("wrapper",(0,a.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"security"},"Security"),(0,r.kt)("h3",{id:"contact-information"},"Contact Information"),(0,r.kt)("p",null,"Email spr-security ","[at]"," longterm.io or reach out on the ",(0,r.kt)("a",{parentName:"p",href:"https://matrix.to/#/#spr:matrix.org"},"matrix chat")),(0,r.kt)("h1",{id:"security-goals"},"Security Goals"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Router is secure against compromises via the web services, remote uplink, or local network attack surfaces")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Practical to use strong passwords for wifi devices")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"One compromised device should not be able to impersonate other devices on the network or intercept their network traffic")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Devices can only communicate to systems they are explicitly allowed to. No spoofing.")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"threat-actors"},"Threat Actors"),(0,r.kt)("h4",{id:"remote-internet-attacker"},"Remote Internet Attacker"),(0,r.kt)("p",null,"Anyone on the internet that can send packets to the WAN/Uplink interface"),(0,r.kt)("h4",{id:"man-in-the-middle--malicious-isp"},"Man In The Middle / Malicious ISP"),(0,r.kt)("p",null,"An attacker with a man in the middle position on the uplink"),(0,r.kt)("h4",{id:"supply-chain-attacker"},"Supply Chain Attacker"),(0,r.kt)("p",null,"An attacker looking to insert code into the SPR project to compromise routers"),(0,r.kt)("h4",{id:"physical-proximity-attacker-evil-neighbor"},"Physical Proximity Attacker (Evil Neighbor)"),(0,r.kt)("p",null,"An attacker with physical proximity to WiFi"),(0,r.kt)("h4",{id:"inside-perimeter-attacker-evil-guest"},"Inside Perimeter Attacker (Evil Guest)"),(0,r.kt)("p",null,"An attacker with physical access"),(0,r.kt)("h4",{id:"compromised-device-attacker-implant"},"Compromised Device Attacker (Implant)"),(0,r.kt)("p",null,"An attacker operating from a compromised device, authenticated on the network"),(0,r.kt)("h2",{id:"threat-vectors"},"Threat Vectors"),(0,r.kt)("h3",{id:"network-flaws"},"Network Flaws"),(0,r.kt)("h4",{id:"weak-passphrase--password-reuse"},"Weak Passphrase / Password Reuse"),(0,r.kt)("h4",{id:"arp-spoofing"},"ARP Spoofing"),(0,r.kt)("h4",{id:"mac-spoofing"},"MAC Spoofing"),(0,r.kt)("h4",{id:"dhcp-mac-spoofing"},"DHCP MAC Spoofing"),(0,r.kt)("h4",{id:"vlan-hopping"},"VLAN Hopping"),(0,r.kt)("h4",{id:"insecure-private-requests-from-web-browsers"},"Insecure Private Requests from Web Browsers"),(0,r.kt)("h3",{id:"software-implementation-flaws"},"Software Implementation Flaws"),(0,r.kt)("h4",{id:"memory-corruption"},"Memory corruption"),(0,r.kt)("h4",{id:"command-injection"},"Command Injection"),(0,r.kt)("h4",{id:"xss-csrf"},"XSS, CSRF"),(0,r.kt)("h4",{id:"dns-cache-poisoning"},"DNS Cache Poisoning"),(0,r.kt)("h4",{id:"response-splitting-attacks"},"Response Splitting Attacks"),(0,r.kt)("h3",{id:"80211-flaws"},"802.11 Flaws"),(0,r.kt)("h4",{id:"cryptographic-vulnerabilities"},"Cryptographic Vulnerabilities"),(0,r.kt)("h4",{id:"password-cracking"},"Password Cracking"),(0,r.kt)("h4",{id:"frag-attacks"},"Frag Attacks"),(0,r.kt)("h4",{id:"mitm"},"MITM"),(0,r.kt)("h4",{id:"ap-isolation-bypass"},"AP Isolation Bypass"),(0,r.kt)("h4",{id:"packet-in-packet-attacks"},"Packet in Packet Attacks"),(0,r.kt)("h2",{id:"key-security-features"},"Key Security Features"),(0,r.kt)("h2",{id:"multi-psk--vlans"},"Multi-PSK & VLANs"),(0,r.kt)("p",null,'SPR places each WiFi device into its own VLAN. The device password and MAC address combination\nis used to authenticate into the DHCP assigned VLAN. The device does not need to be aware it is in a VLAN,\nexcept that DHCP has provided a /30 "tiny" network, and communications to other LAN devices should be routed\nover the AP.'),(0,r.kt)("p",null,"There is no limit to the number of VLANs and a user does not have to assign devices to VLANs."),(0,r.kt)("h3",{id:"no-mac-spoofing-and-other-layer-2-network-pivoting"},"No MAC spoofing and other layer 2 network pivoting"),(0,r.kt)("p",null,"Firewall rules enforce the MAC address for the authenticated device to block MAC spoofing.\nFurther OS configuration blocks ARP spoofing from interfaces on a VLAN.  The packet forwarding\nto other devices is default deny. If a device is part of the all devices LAN group, or is in a group with\nother devices then traffic will be allowed."),(0,r.kt)("p",null,"GTK are unique per VLAN so devices can't bypass the router to communicate. TDLS is disabled."),(0,r.kt)("p",null,"These rules are also enforced with mesh networking, supported today in SPR PLUS over wired backhaul."),(0,r.kt)("h3",{id:"multicast-limitation"},"Multicast Limitation"),(0,r.kt)("p",null,"Currently the multicast proxy will relay multicast traffic to all devices. A further hardening step\nis to enforce routing policy for multicast traffic as well."),(0,r.kt)("h2",{id:"upstream-lan-traffic-blocked-by-default"},"Upstream LAN Traffic Blocked By Default"),(0,r.kt)("p",null,'Typically, users of SPR will plug the SPR into their existing network which will be called an upstream LAN.\nBy default, SPR will block traffic to upstream LANs for devices, unless the "lan_upstream" tag is enabled.\nDevices can still communicate with the internet'),(0,r.kt)("h2",{id:"wpa3-support"},"WPA3 Support"),(0,r.kt)("p",null,"WPA3 uses the Simultaneous Authentication of Equals (SAE) protocol for authentication.\nThe Key Exchange can not be sniffed and cracked as with WPA2 (PBKDF2 based) because it's\na zero knowledge-proof of the password."),(0,r.kt)("p",null,"WPA3 Also provides for Management Frame Protection (MFP) 802.1w which is optional for WPA2 but mandatory in WPA3."),(0,r.kt)("h3",{id:"practical-limitations-of-wpa3"},"Practical Limitations of WPA3"),(0,r.kt)("h4",{id:"ios-device-qr-code-wpa2-downgrade"},"iOS Device QR-Code WPA2 Downgrade"),(0,r.kt)("p",null,"iOS has a long standing flaw where networks with WPA3 that are scanned with a QR Code\nare later saved as WPA2. As a result, SPR supports both WPA2 and WPA3 for devices."),(0,r.kt)("h4",{id:"many-devices-dont-support-wpa3-yet-some-still-require-wpa1-even"},"Many devices don't support WPA3 yet, some still require WPA1 even"),(0,r.kt)("p",null,"Since not all devices support WPA3, a bssid, SPR runs MFP with mixed mode (ieee80211w=1)."))}d.isMDXComponent=!0}}]);